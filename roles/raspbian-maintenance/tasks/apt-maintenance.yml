---
- name: Package maintenance | Update APT package cache
  action: apt update_cache=yes cache_valid_time=3600

- name: Package maintenance | Install "extra" packages
  apt: pkg={{ item }} state=installed update_cache={{ always_update_cache }}
  with_items: "{{ extra_packages_to_install }}"
  when: install_extra_packages

- name: Package maintenance | Upgrade to latest packages
  action: apt upgrade=safe

# - name: Package maintainance | Reboot
#   command: sleep 2 && reboot
#   async: 1
#   poll: 0
#   ignore_errors: true

# - name: Package maintenance | Wait for Raspberry PI to come back
#   local_action: wait_for host={{ ansible_ssh_host }} port=22 state=started delay=10
#   become: false
